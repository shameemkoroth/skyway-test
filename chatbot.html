<iframe 
    src="../chatbot.html" 
    id="skyway-chatbot-frame" 
    width="80px"  
    height="80px" 
    frameborder="0" 
    title="Skyway Bot Chat Assistant"
    scrolling="no" 
    style="
        /* CSS to position the widget */
        position: fixed; 
        bottom: 20px; 
        right: 20px; 
        z-index: 1000;
        
        /* Initial styling for the icon */
        border: none;
        border-radius: 50%; 
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease-in-out; 
    "
>
</iframe>

<script>
    const iframe = document.getElementById('skyway-chatbot-frame');
    let isChatExpanded = false;

    // Function to expand the chat
    function expandChat() {
        if (isChatExpanded) return;
        iframe.style.width = '420px';
        iframe.style.height = '500px';
        iframe.style.borderRadius = '10px';
        isChatExpanded = true;
        
        // Tell the iframe to show the chat and hide the icon
        iframe.contentWindow.postMessage('showChat', '*');
    }

    // Function to collapse the chat
    function collapseChat() {
        if (!isChatExpanded) return;
        iframe.style.width = '80px';
        iframe.style.height = '80px';
        iframe.style.borderRadius = '50%';
        isChatExpanded = false;
        
        // Tell the iframe to show the icon and hide the chat
        iframe.contentWindow.postMessage('showIcon', '*');
    }

    // 1. Initial click on the small iframe (the icon)
    iframe.onclick = expandChat;

    // 2. Listen for messages from the iframe (e.g., when the user clicks the 'X' button inside the chat)
    window.addEventListener('message', function(event) {
        if (event.data === 'expandChat') {
            expandChat();
        } else if (event.data === 'collapseChat') {
            collapseChat();
        }
    });

    // Ensure the chat starts in the collapsed state (showIcon on load)
    window.onload = collapseChat;
</script>
